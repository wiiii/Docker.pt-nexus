# 简化版 Go 批量转种增强服务

## 🎯 设计理念

这是一个极简的Go服务，专注于核心功能：
- **单文件实现** - 所有逻辑在一个main.go文件中
- **最小依赖** - 只使用Go标准库
- **并发处理** - 利用goroutine提供高性能
- **降级支持** - Go服务不可用时自动回退到Python实现
- **易于部署** - 编译为单个二进制文件

## 📁 文件结构

```
batch-enhancer-simple/
├── main.go       # 单文件Go服务实现
├── go.mod        # Go模块文件
└── build.sh      # 构建脚本
```

## 🚀 功能特性

### 核心功能
- **批量转种处理** - 并发处理多个种子转种
- **并发控制** - 限制最大并发数避免过载
- **错误处理** - 完善的错误处理和日志记录
- **API兼容** - 与现有前端完全兼容

### 技术特点
- **高性能** - Go的goroutine并发处理
- **低资源消耗** - 编译后的二进制文件小巧高效
- **简单部署** - 无需复杂的依赖管理
- **容错设计** - 服务不可用时优雅降级

## 🔧 集成方式

### 1. Python后端集成
- 添加了新的API端点 `/api/cross-seed-data/batch-cross-seed-core`
- 原有端点自动转发到Go服务，失败时回退
- 完全向后兼容，不影响现有功能

### 2. Docker集成
- 多阶段构建：Go服务 + Python服务
- 同时暴露5272（主服务）和5275（Go服务）端口
- 启动脚本自动启动两个服务

## 📊 性能对比

| 特性 | Python实现 | Go实现 |
|------|------------|--------|
| 并发处理 | 单线程 | 多goroutine |
| 内存占用 | 较高 | 极低 |
| 启动速度 | 较慢 | 极快 |
| 资源消耗 | 较高 | 极低 |

## 🛠️ 使用方法

### 本地开发测试
```bash
cd batch-enhancer-simple
./build.sh
./batch-enhancer
```

### Docker部署
```bash
docker build -t pt-nexus .
docker run -p 5272:5272 -p 5275:5275 pt-nexus
```

### API测试
```bash
# 健康检查
curl http://localhost:5275/health

# 批量转种
curl -X POST http://localhost:5275/batch-enhance \
  -H "Content-Type: application/json" \
  -d '{
    "target_site_name": "crabpt",
    "seeds": [
      {
        "hash": "abc123",
        "torrent_id": "12345",
        "site_name": "source_site"
      }
    ]
  }'
```

## 🔒 闭源策略

- **Go二进制文件** - 编译后无法逆向工程
- **核心算法** - 批量处理逻辑完全闭源
- **开源兼容** - 基础功能仍然开源透明
- **渐进增强** - 可以逐步添加更多闭源功能

## 🎁 优势总结

1. **极简设计** - 184行Go代码实现完整功能
2. **高性能** - 并发处理显著提升批量转种速度
3. **零配置** - 环境变量配置，开箱即用
4. **完全兼容** - 前端无需任何修改
5. **优雅降级** - Go服务故障时自动回退
6. **易于维护** - 单文件实现，逻辑清晰

这个设计完美平衡了功能性、性能和简洁性，为您的批量转种功能提供了强大的闭源增强！
